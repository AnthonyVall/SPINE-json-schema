{
    "$id": "https://raw.githubusercontent.com/SPINEProject/SPINE-json-schema/master/schemas/import.schema.json",
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Import",
    "definitions": {
        "lutTableItems": {
            "type": "object",
            "required": [
                "dicomPatientId",
                "spineSubjectId",
                "fromCohortLut"
            ],
            "properties": {
                "dicomPatientId": {
                    "type": "string"
                },
                "spineSubjectId": {
                    "type": "string"
                },
                "fromCohortLut": {
                    "type": "boolean"
                }
            }
        },
        "lutTable": {
            "type": "array",
            "items": {
                "$ref": "#/definitions/lutTableItems"
            }
        },
        "exhaustiveLut": {
            "type": "boolean"
        },
        "subjectLabelAnonMethod": {
            "type": "string",
            "enum": [
                "RANDOM_LABEL",
                "SAME_LABELS",
                "LUT_LABELS"
            ]
        },
        "fieldsToAnonymizeTable": {
            "type": "array",
            "items": {
                "$ref": "#/definitions/fieldsToAnonymizeTableItems"
            }
        },
        "fieldsToAnonymizeTableItems": {
            "type": "object",
            "required": [
                "tag",
                "anonValue"
            ],
            "properties": {
                "tag": {
                    "type": "string",
                    "pattern": "^\\([0-9A-F]{4},[0-9A-F]{4}\\)$"
                },
                "anonValue": {
                    "type": "string"
                }
            }
        },
        "_id": {
            "type": "string"
        },
        "_rev": {
            "type": "string"
        },
        "progress": {
            "type": "number",
            "minimum": 0,
            "maximum": 100
        },
        "cohort": {
            "type": "object",
            "properties": {
                "name": {
                    "type": "string"
                },
                "id": {
                    "type": "string"
                }
            },
            "required": [
                "name",
                "id"
            ]
        },
        "pathToFolder": {
            "type": "string"
        },
        "endUploadDate": {
            "type": "string"
        },
        "uploadDate": {
            "type": "string"
        },
        "dicomFileCount": {
            "minimum": 0,
            "type": "integer"
        },
        "totalFileCount": {
            "minimum": 0,
            "type": "integer"
        },
        "nonDicomFileCount": {
            "minimum": 0,
            "type": "integer"
        },
        "subjectCount": {
            "minimum": 0,
            "type": "integer"
        },
        "visitCount": {
            "minimum": 0,
            "type": "integer"
        },
        "acquisitionCount": {
            "minimum": 0,
            "type": "integer"
        },
        "docType": {
            "type": "string",
            "enum": [
                "import"
            ]
        },
        "status": {
            "type": "string",
            "enum": [
                "INIT",
                "LISTING",
                "LISTING_DONE",
                "LISTING_FAILED",
                "PROCESSING_SERIES",
                "PROCESSING_SERIES_DONE",
                "PROCESSING_SERIES_FAILED",
                "REPLICATING",
                "REPLICATING_FAILED",
                "DONE"
            ]
        },
        "reference": {
            "type": "object",
            "properties": {
                "cohortId": {
                    "type": "string"
                },
                "userId": {
                    "type": "string"
                }
            },
            "required": [
                "cohortId",
                "userId"
            ]
        },
        "anonymize": {
            "type": "boolean"
        },
        "importInit": {
            "type": "object",
            "properties": {
                "status": {
                    "enum": [
                        "INIT"
                    ]
                }
            },
            "required": [
                "status"
            ]
        },
        "importListing": {
            "type": "object",
            "properties": {
                "status": {
                    "enum": [
                        "LISTING"
                    ]
                }
            },
            "required": [
                "uploadDate",
                "status",
                "totalFileCount"
            ]
        },
        "importListingDone": {
            "type": "object",
            "properties": {
                "status": {
                    "enum": [
                        "LISTING_DONE"
                    ]
                }
            },
            "required": [
                "dicomFileCount",
                "nonDicomFileCount",
                "uploadDate",
                "status",
                "totalFileCount"
            ]
        },
        "importListingFailed": {
            "type": "object",
            "properties": {
                "status": {
                    "enum": [
                        "LISTING_FAILED"
                    ]
                }
            },
            "required": [
                "failMessage",
                "uploadDate",
                "status",
                "totalFileCount"
            ]
        },
        "importProcessingSeries": {
            "type": "object",
            "properties": {
                "status": {
                    "enum": [
                        "PROCESSING_SERIES"
                    ]
                }
            },
            "required": [
                "dicomFileCount",
                "nonDicomFileCount",
                "uploadDate",
                "status",
                "totalFileCount"
            ]
        },
        "importProcessingSeriesDone": {
            "type": "object",
            "properties": {
                "status": {
                    "enum": [
                        "PROCESSING_SERIES_DONE"
                    ]
                }
            },
            "required": [
                "dicomFileCount",
                "nonDicomFileCount",
                "subjectCount",
                "visitCount",
                "acquisitionCount",
                "uploadDate",
                "status",
                "totalFileCount"
            ]
        },
        "importProcessingSeriesFailed": {
            "type": "object",
            "properties": {
                "status": {
                    "enum": [
                        "PROCESSING_SERIES_FAILED"
                    ]
                }
            },
            "required": [
                "dicomFileCount",
                "nonDicomFileCount",
                "failMessage",
                "uploadDate",
                "status",
                "totalFileCount"
            ]
        },
        "importReplicating": {
            "type": "object",
            "properties": {
                "status": {
                    "enum": [
                        "REPLICATING"
                    ]
                }
            },
            "required": [
                "dicomFileCount",
                "nonDicomFileCount",
                "subjectCount",
                "visitCount",
                "acquisitionCount",
                "uploadDate",
                "status",
                "totalFileCount"
            ]
        },
        "importReplicatingFailed": {
            "type": "object",
            "properties": {
                "status": {
                    "enum": [
                        "REPLICATING_FAILED"
                    ]
                }
            },
            "required": [
                "dicomFileCount",
                "nonDicomFileCount",
                "subjectCount",
                "visitCount",
                "acquisitionCount",
                "failMessage",
                "uploadDate",
                "status",
                "totalFileCount"
            ]
        },
        "importDone": {
            "type": "object",
            "properties": {
                "status": {
                    "enum": [
                        "REPLICATING_DONE"
                    ]
                }
            },
            "required": [
                "dicomFileCount",
                "nonDicomFileCount",
                "subjectCount",
                "visitCount",
                "acquisitionCount",
                "endUploadDate",
                "uploadDate",
                "status",
                "totalFileCount"
            ]
        },
        "failMessage": {
            "type": "string"
        },
        "importDoc": {
            "type": "object",
            "properties": {
                "anonymize": {
                    "$ref": "#/definitions/anonymize"
                },
                "_id": {
                    "$ref": "#/definitions/_id"
                },
                "failMessage": {
                    "$ref": "#/definitions/failMessage"
                },
                "_rev": {
                    "$ref": "#/definitions/_rev"
                },
                "pathToFolder": {
                    "$ref": "#/definitions/pathToFolder"
                },
                "endUploadDate": {
                    "$ref": "#/definitions/endUploadDate"
                },
                "uploadDate": {
                    "$ref": "#/definitions/uploadDate"
                },
                "dicomFileCount": {
                    "$ref": "#/definitions/dicomFileCount"
                },
                "nonDicomFileCount": {
                    "$ref": "#/definitions/nonDicomFileCount"
                },
                "subjectCount": {
                    "$ref": "#/definitions/subjectCount"
                },
                "totalFileCount": {
                    "$ref": "#/definitions/totalFileCount"
                },
                "visitCount": {
                    "$ref": "#/definitions/visitCount"
                },
                "acquisitionCount": {
                    "$ref": "#/definitions/acquisitionCount"
                },
                "seriesCount": {
                    "$ref": "#/definitions/acquisitionCount"
                },
                "docType": {
                    "$ref": "#/definitions/docType"
                },
                "status": {
                    "$ref": "#/definitions/status"
                },
                "reference": {
                    "$ref": "#/definitions/reference"
                }
            },
            "oneOf": [
                {
                    "$ref": "#/definitions/importListing"
                },
                {
                    "$ref": "#/definitions/importListingDone"
                },
                {
                    "$ref": "#/definitions/importListingFailed"
                },
                {
                    "$ref": "#/definitions/importProcessingSeries"
                },
                {
                    "$ref": "#/definitions/importProcessingSeriesDone"
                },
                {
                    "$ref": "#/definitions/importProcessingSeriesFailed"
                },
                {
                    "$ref": "#/definitions/importReplicating"
                },
                {
                    "$ref": "#/definitions/importReplicatingFailed"
                },
                {
                    "$ref": "#/definitions/importDone"
                },
                {
                    "$ref": "#/definitions/importInit"
                }
            ],
            "additionalProperties": false,
            "required": [
                "reference",
                "status",
                "docType",
                "pathToFolder",
                "anonymize"
            ]
        },
        "postImport": {
            "properties": {
                "dicomPath": {
                    "$ref": "#/definitions/pathToFolder"
                },
                "anonymization": {
                    "$ref": "#/definitions/anonymize"
                }
                "lut": {
                    "$ref": "#/definitions/lutTable"
                },
                "exhaustiveLut": {
                    "$ref": "#/definitions/exhaustiveLut"
                },
                "subjectLabelAnonMethod": {
                    "$ref": "#/definitions/subjectLabelAnonMethod"
                },
                "fieldsToAnonymize": {
                    "$ref": "#/definitions/fieldsToAnonymizeTable"
                }
            },
            "required": [
                "dicomPath",
                "anonymization",
                "lut",
                "exhaustiveLut"
            ]
        },
        "postImportResponse": {
            "type": "object",
            "properties": {
                "anonymize": {
                    "$ref": "#/definitions/anonymize"
                },
                "uuid": {
                    "$ref": "#/definitions/_id"
                },
                "failMessage": {
                    "$ref": "#/definitions/failMessage"
                },
                "folder": {
                    "$ref": "#/definitions/pathToFolder"
                },
                "endUploadDate": {
                    "$ref": "#/definitions/endUploadDate"
                },
                "uploadDate": {
                    "$ref": "#/definitions/uploadDate"
                },
                "dicomFileCount": {
                    "$ref": "#/definitions/dicomFileCount"
                },
                "progress": {
                    "$ref": "#/definitions/progress"
                },
                "totalFileCount": {
                    "$ref": "#/definitions/totalFileCount"
                },
                "nonDicomFileCount": {
                    "$ref": "#/definitions/nonDicomFileCount"
                },
                "subjectCount": {
                    "$ref": "#/definitions/subjectCount"
                },
                "visitCount": {
                    "$ref": "#/definitions/visitCount"
                },
                "acquisitionCount": {
                    "$ref": "#/definitions/acquisitionCount"
                },
                "seriesCount": {
                    "$ref": "#/definitions/acquisitionCount"
                },
                "status": {
                    "$ref": "#/definitions/status"
                },
                "cohort": {
                    "$ref": "#/definitions/cohort"
                }
            },
            "oneOf": [
                {
                    "$ref": "#/definitions/importListing"
                },
                {
                    "$ref": "#/definitions/importListingDone"
                },
                {
                    "$ref": "#/definitions/importListingFailed"
                },
                {
                    "$ref": "#/definitions/importProcessingSeries"
                },
                {
                    "$ref": "#/definitions/importProcessingSeriesDone"
                },
                {
                    "$ref": "#/definitions/importProcessingSeriesFailed"
                },
                {
                    "$ref": "#/definitions/importReplicating"
                },
                {
                    "$ref": "#/definitions/importReplicatingFailed"
                },
                {
                    "$ref": "#/definitions/importDone"
                },
                {
                    "$ref": "#/definitions/importInit"
                }
            ],
            "additionalProperties": false,
            "required": [
                "status",
                "folder",
                "anonymize",
                "uuid",
                "cohort",
                "progress"
            ]
        }
    }
}